
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/_variability_ERP.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples__variability_ERP.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples__variability_ERP.py:


Example: Intra-Subject Variability of ERP
============================================

.. GENERATED FROM PYTHON SOURCE LINES 5-10

.. code-block:: Python


    # Authors: Simon Kojima <simon.kojima@inria.fr>
    #
    # License: BSD (3-clause)


.. GENERATED FROM PYTHON SOURCE LINES 11-15

.. code-block:: Python

    import mne
    import nearby
    from moabb.datasets import Kojima2024B


.. GENERATED FROM PYTHON SOURCE LINES 16-55

.. code-block:: Python

    """
    Extract Epochs
    """

    subject = 1
    l_freq = 1
    h_freq = 40
    resample = 128
    tmin = -0.1
    tmax = 1.2
    baseline = [-0.05, 0.0]

    dataset = Kojima2024B(task="2stream")

    data = dataset.get_data(subjects=[subject])

    raws = list(data[subject]["0"].values())

    for raw in raws:
        raw.filter(
            l_freq=l_freq,
            h_freq=h_freq,
            method="iir",
            iir_params={"ftype": "butter", "btype": "bandpass", "order": 4},
            phase="zero",
        )

    raw = mne.concatenate_raws(raws)

    raw.pick(picks="eeg")

    epochs = mne.Epochs(raw, baseline=None, tmin=tmin, tmax=tmax)

    epochs.load_data()

    epochs.resample(resample)

    epochs = epochs.apply_baseline(baseline=baseline)


.. GENERATED FROM PYTHON SOURCE LINES 56-70

.. code-block:: Python

    """
    # Within-Trial Temporal (WTTemp)
    """
    wt_temp = nearby.metrics.within_trial_temporal(
        epochs["Target"],
        tmin=tmin,
        tmax=tmax,
        picks=["Cz", "CPz", "Pz"],
    )

    print(wt_temp)

    exit()


.. GENERATED FROM PYTHON SOURCE LINES 71-83

.. code-block:: Python

    """
    # ATTV
    """
    attv = nearby.metrics.attv(
        epochs["Target"],
        tmin=tmin,
        tmax=tmax,
        picks=["Cz", "CPz", "Pz"],
    )

    attv = attv["attv"].mean()


.. GENERATED FROM PYTHON SOURCE LINES 84-96

.. code-block:: Python

    """
    # ATSVA
    """
    atsva = nearby.metrics.atsv(
        epochs["Target"],
        tmin=tmin,
        tmax=tmax,
        metrics="angle",
    )

    atsva = atsva["atsva"].mean()


.. GENERATED FROM PYTHON SOURCE LINES 97-107

.. code-block:: Python

    """
    Print results
    """

    print("# Variability Metrics")
    print(f" - ME    : {me:10.6f}")
    print(f" - SMEAT : {smeat:10.6f}")
    print(f" - WTTV  : {wttv:10.6f}")
    print(f" - ATTV  : {attv:10.6f}")
    print(f" - ATSVA : {atsva:10.6f}")


.. _sphx_glr_download_auto_examples__variability_ERP.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: _variability_ERP.ipynb <_variability_ERP.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: _variability_ERP.py <_variability_ERP.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: _variability_ERP.zip <_variability_ERP.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
